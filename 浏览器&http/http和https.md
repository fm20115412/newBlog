[TOC]

## http的缺点
- 通信使用明文，内容可能会被**窃听**
- 不验证通信方的身份，因此可能遭遇**伪装**
- 无法验证报文的完整性，所以有可能被**篡改**
## https
https = http + 加密 + 认证 + 完整性保护

https并非是应用层的一种新协议。只是http通信接口部分用ssl和tls协议代替而已。
通常，http直接和tcp通信。当使用ssl时，则演变成先和ssl通信，再由ssl和tcp通信了。简言之，所谓https，其实就是身披ssl协议这层外壳的http。

![](./images/5.png)
### https通信过程
详细过程比较复杂
可参考[从加密解密演进看 https 通信（下）——https 通信流程](https://juejin.im/post/5d8e98b96fb9a04e2c014bd9)这篇文章的https 通信流程部分，讲得很详细。
[学习笔记—浏览器](https://note.youdao.com/ynoteshare1/index.html?id=4cf504041a7e1981749bd84672e7ee29&type=note)中http 向 https 演化的过程部分
### 简易过程
- 客户端向服务端发送请求；
- 服务端返回数字证书；
- 客户端用自己的CA（主流的CA机构证书一般都内置在各个主流浏览器中）公钥去解密证书，如果证书有问题会提示风险；
- 如果证书没问题，客户端会生成一个对称加密的随机秘钥然后再和刚刚解密的服务器端的公钥对数据进行加密，然后发送给服务器端；
- 服务器端收到以后会用自己的私钥对客户端发来的对称秘钥进行解密；
- 之后双方就拿着这个对称加密秘钥来进行正常的通信。
### 总结
对于报文的加密，https 采用混合加密机制，在交换密钥环节，使用非对称加密，在之后通信交换报文阶段则使用对称加密方式。https 的握手流程，其实就是 ssl 建立连接的过程，身份验证就是利用 CA 证书来验证对方的身份，有单向认证也有双向认证。
## http和https的比较
http传输的数据都是未加密的，也就是明文的，网景公司设置了ssl协议来对http协议传输的数据进行加密处理，简单来说https协议是由http和ssl协议构建的可进行加密传输和身份认证的网络协议，比http协议的安全性更高。 主要的区别如下：

|                 | http                                                     | https                                                 |
| --------------- | -------------------------------------------------------- | ----------------------------------------------------- |
| 全称            | Hyper Text Transfer Protocol                             | Hyper Text Transfer Protocol over Secure Socket Layer |
| 中文名          | 超文本传输协议                                           | 超文本传输安全协议                                    |
| CA证书          | 不需要                                                   | 需要到CA申请证书，一般免费证书较少，因而需要一定费用  |
| 端口            | 80                                                       | 443                                                   |
| 安全性          | 不安全，信息明文传输，容易被篡改，无法验证通信双方的身份 | 安全，具有安全性的ssl加密传输协议                     |
| 访问速度        | 访问快                                                   | ssl握手，对https访问速度可能会有一定程度的降低        |
| 服务器端cpu压力 | 不会对cpu产生太大的压力                                  | https中大量的密钥算法计算，会消耗大量的cpu资源        |
## https的优缺点
### 优点
- https协议是由ssl+http协议构建的可进行加密传输、身份认证的网络协议，要比http协议安全，可防止数据在传输过程中不被窃取、改变，确保数据的完整性。
- 使用https协议可认证用户和服务器，确保数据发送到正确的客户机和服务器。
### 缺点
- https协议握手阶段比较费时，会使页面的加载时间延长；
- ssl证书需要钱，功能越强大的证书费用越高；
- https大量的加密解密算法对服务端cpu压力较大。
